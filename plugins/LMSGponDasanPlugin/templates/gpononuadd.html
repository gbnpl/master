{include file="header.html"}
<!--// $Id$ //-->
{include file="calendar_js.html"}
{$xajax}
<SCRIPT TYPE="text/javascript" SRC="img/{LMSGponDasanPlugin::plugin_directory_name}/gpon.js""></SCRIPT>
<H1>{$layout.pagetitle}</H1>
<FORM NAME="netdevadd" METHOD="POST" ACTION="?m=gpononuadd&onu_check_add={$onu_check_add}">
<INPUT type="submit" class="hiddenbtn">
<INPUT TYPE="hidden" NAME="pots_1_phone" ID="pots_1_phone" VALUE="{$netdev.voipaccountsid1}"> 
<INPUT TYPE="hidden" NAME="pots_2_phone" ID="pots_2_phone" VALUE="{$netdev.voipaccountsid2}"> 
<INPUT TYPE="hidden" NAME="hostid_1" ID="hostid_1" VALUE="{$netdev.host_id1}">
<INPUT TYPE="hidden" NAME="hostid_2" ID="hostid_2" VALUE="{$netdev.host_id2}">

<TABLE WIDTH="100%" CELLPADDING="3">
{if $onu_check_add}
	<TR class="dark">
		<TD WIDTH="1%" class="fleftu">
			<IMG SRC="img/{LMSGponDasanPlugin::plugin_directory_name}/gponolt.gif" ALT="">
		</TD>
		<TD WIDTH="1%" class="fbt">
		<b>OLT:</b>
		<TD WIDTH="98%" class="frightu">{$netdev.olt_data}
		</TD>
	</TR>
{/if}
	<TR class="dark">
		<TD WIDTH="1%" class="fleftu">
			<IMG SRC="img/{LMSGponDasanPlugin::plugin_directory_name}/gpononu.gif" ALT="">
		</TD>
		<TD WIDTH="1%" class="fbt">
			<B>{trans("Name:")}</B>
		<TD WIDTH="98%" class="frightu">
		{if $onu_check_add}
		<INPUT TYPE="TEXT" NAME="netdev[name]" VALUE="{$netdev.name}" {tip trigger="name" text="Enter ONU device name (for Dasan ONUs it should begin with 'DSNW')" bold=1} readonly="readonly">
		<INPUT TYPE="hidden" NAME="olt_port" VALUE="{$netdev.olt_port}"> 
		<INPUT TYPE="hidden" NAME="netdevicesid" VALUE="{$netdev.olt_netdevicesid}"> 
		<INPUT TYPE="hidden" NAME="onu_id" VALUE="{$netdev.onu_id}"> 
		<INPUT TYPE="hidden" NAME="netdev[onu_model]" VALUE="{$netdev.onu_model}"> 
		
		<INPUT TYPE="hidden" NAME="gponoltid" VALUE="{$netdev.gponoltid}"> 
		
		{else}
		<INPUT TYPE="TEXT" NAME="netdev[name]" VALUE="{$netdev.name}" MAXLENGTH="20" {tip trigger="name" text="Enter ONU device name (for Dasan ONUs it should begin with 'DSNW')" bold=1}>
		{/if}
		</TD>
	</TR>
	{if $onu_check_add}
	<TR class="light">
		<TD WIDTH="1%" class="fleftu">
			<IMG SRC="img/{LMSGponDasanPlugin::plugin_directory_name}/gponolt.gif" ALT="">
		</TD>
		<TD WIDTH="1%" class="fbt">
		<b>ONU ID:</b>
		<TD WIDTH="98%" class="frightu">{$netdev.onu_id}
		</TD>
	</TR>
{/if}
	<TR class="light">
                <TD WIDTH="100%" COLSPAN="3" class="flr">
		        <TABLE WIDTH="100%" CELLPADDING="0">
				<TR class="light">
					<TD WIDTH="50%" style="vertical-align:top;">
					        <TABLE WIDTH="100%" CELLPADDING="3">
					        

	<TR class="light">
		<TD style="width: 1%;">
			<IMG SRC="img/settings.gif" ALT="">
		</TD>
		<TD style="width: 1%;" class="bold nobr">
			<label for="autoprovisioning">Wydany do klienta:</label>
		</TD>
		<TD style="width: 98%;">
			<input type="checkbox" name="netdev[autoprovisioning]" id="autoprovisioning" value="1"{if $netdev.autoprovisioning} checked{/if}>
		</TD>
	</TR>

	<TR class="light">
		<TD style="width: 1%;">
			<IMG SRC="img/settings.gif" ALT="">
		</TD>
		<TD style="width: 1%;" class="bold nobr">
			<label for="xmlprovisioning">{trans("XML provisioning:")}</label>
		</TD>
		<TD style="width: 98%;">
			<input type="checkbox" name="netdev[xmlprovisioning]" id="xmlprovisioning" value="1"{if $netdev.xmlprovisioning} checked{/if} onchange="javascript:xajax_ONU_UpdateProperties(this.checked, xjx.$('gpononumodelsid').value);">
		</TD>
	</TR>

	<TR class="light">
		<TD WIDTH="1%">
			<IMG SRC="img/settings.gif" ALT="">
		</TD>
		<TD WIDTH="1%" NOWRAP>
			<B>Profil:</B>
		</TD>
		<TD WIDTH="98%">
			<SELECT {tip trigger="gponoltprofiles"} SIZE="1" NAME="netdev[gponoltprofilesid]" {tip text="Wybierz profil"}>
			<option value="">Wybierz</option>
				{foreach $gponoltprofiles as $profile}
				<OPTION VALUE="{$profile.id}"{if $netdev.gponoltprofilesid == $profile.id} selected{/if}>{$profile.name}{if array_key_exists('oltname', $profile)} ({$profile.oltname}){/if}</OPTION>
				{/foreach}
			</SELECT>
		</TD>
	</TR>
					        
					        <TR class="light">
		<TD WIDTH="1%">
			<IMG SRC="img/netdev_model.gif" ALT="">
		</TD>
		<TD WIDTH="1%" NOWRAP>
			<B>{trans("Model:")}</B>
		</TD>
		<TD WIDTH="98%">
		{if $onu_check_add}
		{$netdev.onu_model}
		{else}
			<SELECT SIZE="1" NAME="netdev[gpononumodelsid]" id="gpononumodelsid" {tip text="Select ONU model"} onchange="javascript:xajax_ONU_UpdateProperties(xjx.$('xmlprovisioning').checked, this.options[this.selectedIndex].value);">
				{foreach $gpononumodels as $model}
				<OPTION VALUE="{$model.id}"{if $netdev.gpononumodelsid == $model.id} selected{/if}>{$model.name}</OPTION>
				{/foreach}
			</SELECT>
			{/if}
		</TD>
	</TR>
	
	
	
	<TR class="light">
		<TD WIDTH="1%">
			<IMG SRC="img/passwd.gif" ALT="">
		</TD>
		<TD WIDTH="1%">
		        <B>{trans("Password:")}</B>
		</TD>
		<TD WIDTH="98%">
		{if $onu_check_add}
	{foreach from=$onucheck key=k1 item=v1}
   <INPUT TYPE="hidden" NAME="onucheck[{$k1}]" VALUE="{$v1}"> 
{/foreach}
{$netdev.onu_passwordResult}
<INPUT TYPE="hidden" NAME="netdev[password]" VALUE="{$netdev.onu_password}">
	{else}
		        <INPUT TYPE="TEXT" maxlength="10" NAME="netdev[password]" VALUE="{$netdev.onu_password}" {tip text="Enter password (optional)" trigger="passwd"}>
		        {/if}
 		</TD>
	</TR>
	
	<TR class="light">
		<TD WIDTH="1%">
			<IMG SRC="img/{LMSGponDasanPlugin::plugin_directory_name}/gpononu.gif" ALT="">
		</TD>
		<TD WIDTH="1%">
			<B>ONU description:</B>
		<TD WIDTH="98%">
		<INPUT TYPE="hidden" NAME="onu_description_old" VALUE="{$netdev.onu_description_old}"> 
		<INPUT TYPE="TEXT" NAME="netdev[onu_description]" VALUE="{$netdev.onu_description}" MAXLENGTH="32"> 
		</TD>
	</TR>
	<TR class="light">
		<TD style="width: 1%;">
			<IMG SRC="img/netdev.gif" ALT="">
		</TD>
		<TD style="width: 1%;" class="bold nobr">
			{trans("Network device:")}
		</TD>
		<TD style="width: 98%;">
			<SELECT name="netdev[netdevid]" {tip text="Select assigned network device"}>
				<OPTION value="0">{trans("- none -")}</OPTION>
				{foreach $notgpononudevices as $device}
				<OPTION value="{$device.id}"{if $netdev.netdevid == $device.id} selected{/if}>{$device.name}</OPTION>
				{/foreach}
			</SELECT>
		</TD>
	</TR>
	<TR class="light">
		<TD WIDTH="1%">
			<IMG SRC="img/customer.gif" ALT="{trans("Customer:")}">
		</TD>
		<TD WIDTH="99%" COLSPAN="2">
		<TABLE>
		<SCRIPT type="text/javascript">
		<!--
			var input_elems = [];

			function customerlist_change() {
				customerids = '';
				for (i = 0; i < input_elems.length; i++)
					customerids += input_elems[i].value + ';'
				customerids += '0;';
				xajax_ONU_Voip_Phone_Xj(customerids,
					document.getElementById('pots_1_phone').value,
					document.getElementById('pots_2_phone').value);
				xajax_ONU_Host_hosts_Xj(customerids,
					document.getElementById('hostid_1').value,
					document.getElementById('hostid_2').value);
			}
		//-->
		</SCRIPT>
		{for $index=0 to $onu_customerlimit-1}
		<TR>
			<TD>
				{$index+1}.
			</TD>
			<TD>
				{$cid="customersid_"|cat:$index}
				{customerlist form="netdevadd" customers=$customers selected=$netdev.$cid selectname="netdev[customersid_$index]" inputname="netdev[cid_$index]" customOnChange="customerlist_change();"}
				<SCRIPT type="text/javascript">
				<!--
					input_elems.push(document.forms['netdevadd'].elements['netdev[cid_{$index}]']);
				//-->
				</SCRIPT>
			</TD>
		</TR>
		{/for}
		<SCRIPT type="text/javascript">
		<!--
			customerlist_change();
		//-->
		</SCRIPT>
		</TABLE>
			
		</TD>
	</TR>
	 </TABLE>
	 <table  id="show_voip" style="display:none;">
	<TR class="light">
		<TD WIDTH="1%">
			<IMG SRC="img/voip.gif" ALT="">
		</TD>
		<TD WIDTH="1%" NOWRAP>
			<B>VoIP:</B>
		</TD>
		<TD WIDTH="98%" id="ONU_Voip_Phone" align="left">

		</TD>
	</TR> </TABLE>
	<table  id="show_host" style="display:block;">
	<TR class="light">
		<TD WIDTH="1%">
			<IMG SRC="img/node.gif" ALT="">
		</TD>
		<TD WIDTH="1%" NOWRAP>
			<B>Host:</B>
		</TD>
		<TD WIDTH="49%" id="ONU_Host_hosts" align="left">

		</TD>
		<td WIDTH="49%" align="left">
		    <table>
			<tr>
			    <td><nobr><img src="img/netdev.gif" alt""> {t}Device:{/t} <input name="devhost1" type="checkbox"></nobr></td>
			    <td><select name="devhost_id1">
			         <OPTION VALUE="0">-- wybierz --</OPTION>
                                 {foreach from=$netdevhosts item=nd}
	                              <OPTION VALUE="{$nd.id}">{$nd.host}</OPTION>
	                         {/foreach}
				</select></td>
			</tr>
			<tr>
			    <td><nobr><img src="img/netdev.gif" alt""> {t}Device:{/t} <input name="devhost2" type="checkbox" {if $netdevinfo.host_id2_dev}checked="checked"{/if} {if $netdevinfo.autoscript eq 1} disabled="disabled" {/if}></nobr></td>
			    <td><select name="devhost_id2" {if $netdevinfo.autoscript eq 1} disabled="disabled" {/if}>
			         <OPTION VALUE="0">-- wybierz --</OPTION>
                                 {foreach from=$netdevhosts item=nd}
	                              <OPTION VALUE="{$nd.id}"{if $netdevinfo.host_id2 eq $nd.id} SELECTED{/if}>{$nd.host}</OPTION>
	                         {/foreach}
				</select></td>
			</tr>
		    </table>
	</TR> </TABLE>
				</TD>
					<TD WIDTH="50%" style="vertical-align:top;">
						<TABLE WIDTH="100%" CELLPADDING="3">
							<tr class="light" id="wifisettings"{if !$netdev.xmlprovisioning || !isset($netdev.portdetails.wifi.portscount)} style="display: none;"{/if}>
								<TD colspan="3">
									<fieldset style="width: 1%;" class="nobr">
										<legend class="bold"><IMG SRC="img/wireless.gif" ALT=""> {trans("WiFi settings")}</legend>
										<table cellpadding="2">
											<tr>
												<TD class="bold nobr">
													{trans("SSID:")}
												</TD>
												<TD>
													<input type="text" name="netdev[properties][wifi_ssid]" id="wifi_ssid" placeholder="{trans("minimum 8 characters")}" value="{$netdev.properties.wifi_ssid}" size="25" {tip trigger="wifi_ssid"}>
												</TD>
											</tr>
											<tr>
												<TD class="bold nobr">
													{trans("Password:")}
												</TD>
												<TD>
													<input type="text" name="netdev[properties][wifi_password]" id="wifi_password" placeholder="{trans("minimum 8 characters")}" value="{$netdev.properties.wifi_password}" size="25" {tip trigger="wifi_password"}>
												</TD>
											</tr>
											{if ConfigHelper::getConfig('gpon-dasan.xml_provisioning_default_wifi_ssid', '') || ConfigHelper::getConfig('gpon-dasan.xml_provisioning_default_wifi_password', '')}
											<tr>
												<TD colspan="2" class="text-center">
													<a onclick="javascript:xajax_ONU_GenerateWifiSettings({$netdevinfo.id});"><IMG src="img/reload.gif" alt=""> {trans("Generate automatically")}</a>
												</TD>
											</tr>
											{/if}
										</table>
									</fieldset>
								</td>
							</tr>
							<tr class="light" id="portsettings"{if !ConfigHelper::checkConfig('gpon-dasan.use_radius') && !$netdevinfo.xmlprovisioning} style="display: none;"{/if}>
								<TD style="width: 1%;">
									<IMG SRC="img/{LMSGponDasanPlugin::plugin_directory_name}/gpononu_takenports.gif" ALT="">
								</td>
								<TD style="width: 1%;" class="bold nobr">
									{trans("<!gpon-dasan>Ports:")}
								</TD>
								<TD style="width: 98%;">
									<table CELLPADDING="2" border="1" rules="cols">
										<tr class="dark">
											<td class="bold">{trans("Port")}</td>
											<td class="bold">{trans("<!gpon-dasan>Administrative status")}</td>
										</tr>
										{foreach $modelports as $modelport}
										{for $port=1 to $modelport.portscount}
										<tr>
											<td class="text-right">
												{$modelport.name} {$port}
											</td>
											<td>
												<SELECT NAME="netdev[portsettings][{$modelport.id}][{$port}][portdisable]">
													<option value="0">{trans("- up -")}</option>
													<option value="1"{if $netdev['portsettings'][$modelport.id][$port]['portdisable']} selected{/if}>{trans("- down -")}</option>
												</SELECT>
											</td>
										</tr>
										{/for}
										{/foreach}
									</table>
								</TD>
							</tr>
						</TABLE>
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>
	<TR class="light">
		<TD WIDTH="100%" class="fbottomu" COLSPAN="3" ALIGN="RIGHT">
			<A HREF="javascript:document.netdevadd.submit();" ACCESSKEY="s">{trans("Submit")} <IMG SRC="img/save.gif" alt=""></A>
			<A HREF="?m=gpononulist">{trans("Cancel")} <IMG SRC="img/cancel.gif" alt=""></A>
		</TD>
	</TR>	
</TABLE>
</FORM>
<SCRIPT type="text/javascript">
<!--
document.forms['netdevadd'].elements['netdev[name]'].focus();
//-->
</SCRIPT>
{include file="footer.html"}
